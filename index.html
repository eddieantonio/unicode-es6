<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Unicode! (And how ES6 can help)</title>

    <meta name="author" content="Eddie Antonio Santos">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/solarized.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!-- Bodge some CSS in here. -->
    <style>
      .reveal code {
        text-transform: none;
      }

      .reveal img.no-border {
        border: 0;
        box-shadow: none;
        margin: 0;
        background: none;
      }

      img.bitter-logo {
        max-height: initial;
        max-width: 75%;
      }

      h2.halo {
        color: black;
        text-shadow: -0.1em -0.1em 1em rgba(255,255,255,1), 1em 0 1em rgba(255,255,255,1), -0.1em 0 1em rgba(255,255,255,1), -0.3em 0.3em 1em rgba(255,255,255,1), -0.3em -0.1em 1em rgba(255,255,255,1);
      }

      span.decomp {
        font: bold 100% Arial Unicode MS, sans-serif;
      }

      /* Makes citatation smaller and italic. */
      .reveal cite {
        font-size: smaller;
        font-style: italic;
      }

      /* Horribly hacky things for big ol' unicode diagram. */
      img.fragment.highlight-blue.unicode-graph {
        box-shadow: none;
        border: 0;

        /* Scale and translation stuff -- hand-tweaked values. */
        transform: scale(2.5) translateX(37.5%);
        transform-origin: top center;
      }

      img.fragment.highlight-blue.unicode-graph.visible.current-fragment {
        transform: scale(0.5);
      }

      /* Unicode stuff. */
      h1.display-character {
        text-transform: none;
        /* Makes Chrome render this in a sane way. */
        font-family: monospace;
      }

      /* Make the hhhh placeholder thing. */
      span.placeholder {
        font-style: italic;
      }
    </style>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">

        <section>
          <h1>Unicode!</h1>
          <h2>(And how ES6 can help)</h2>
          <p>
            <small> By
                <a href="//www.eddieantonio.ca/">Eddie Antonio Santos</a>
                /
                <a href="http://twitter.com/_eddieantonio"> @_eddieantonio </a>
               </small>
          </p>
        </section>

        <section>
          <section>
            <h2 class="fancy"> (Hypothetical Scenario) </h2>

            <aside class="notes" data-markdown>
              - Tomorrow you get hired for a start-up
              - Our visionary CEO has decided that the internet needs a place to
                share its feelings because the intenet has a lot of feelings.
              - But, we don't want them to share *too many* feelings all at
                once; only allow them to share feelings 140 characters at a
                time.
            </aside>
          </section>


          <section>
            <img src="./img/feelings.gif" alt="">
            <aside class="notes" data-markdown>
              - But that's okay; we have a lot of feelings too, so
                the intenet has a lot of feelings.
            </aside>
          </section>

          <section>
            <img src="./img/bitter-standard.png" alt="bitter" class="no-border bitter-logo">

            <p>
              <small> (Thanks, <a href="http://kimber.github.io/">Kim</a>!) </small>
            </p>
          </section>

            <aside class="notes" data-markdown>
              - So this app is called Bitter.
              - It allows you to post short, 140 character long messages.
              - Pretty simple, right?
              - I mean, we have feelings too, but we hope to
                find... alternate... coping mechanisms.
            </aside>

          <section data-background="./img/feelings-money.gif">
            <aside class="notes" data-markdown>
              - With that in mind, let's code it!

              ###### INSTRUCTIONS FOR EDDIE

              - Ensure Bitter is loaded in a browser window
              - Ensure src/index.jsx is loaded in Vim, WITHOUT the message
                length code (have it let message length = 0)
              - Demo the app -- type some stuff in it.
              - Add string.length to message length.
              - Demo the app -- type some stuff in it. The character count
                should increase by 1.
              - `node -e 'console.log("üò≠".repeat(140))' | pbcopy`
              - Copy it, and try `pbpaste | wc -m`
              - Delete some things to demonstrate counting by two.
            </aside>
          </section>

          <section>
            <h2> (demo) </h2>
          </section>
        </section>

        <section>
          <section>
            <h2>
               What does <code>str.length</code> actually measure?
            </h2>
            <p class="fragment"> Let's consult the <a
                href="http://www.ecma-international.org/ecma-262/6.0/#sec-ecmascript-language-types-string-type">standard</a>!
            </p>
          </section>

          <!-- What is a JavaScript String anyway? -->

          <section>
            <blockquote>
              <p> The String type is the set of all ordered sequences of zero
                or more <strong>16-bit unsigned integer values</strong>
                (‚Äúelements‚Äù)
              </blockquote>

            <blockquote class="fragment">
              <p>The String type is generally used to
                represent textual data in a running ECMAScript program, in
                which case each element in the String is treated as a
                <strong>UTF-16 code unit</strong> value.
              </blockquote>

            <div class="fragment">
              <blockquote>
                <p> The length of a String is the
                  <strong>number</strong> of elements (i.e., <strong>16-bit
                    values</strong>) within it.</p>
              </blockquote>

              <cite>
              <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-ecmascript-language-types-string-type">
                ECMAScript 6.0 Standard ¬ß6.1.4</a>
              </cite>
            </div>


            </section>

          <section>
            <h2> What the üëø is a UTF-16 code value‚ÄΩ </h2>
          </section>

        </section>


        <section>
          <section>
            <h1> Unicode! </h1>
          </section>

          <section>
            <h1> What is Unicode? </h1>
            <ul>
              <li class="fragment"> A mapping of numbers (<em>code points</em>) to every character. <span class="fragment">Ever.</span> </li>
              <li class="fragment"> Database of properties for each character (e.g., name, general category). </li>
            </ul>
            <aside class="notes" data-markdown>
              - Unicode is a lot of things.
              - It's the database of characters (among other things).
              - Characters are abstract representations of the smallest units
                of written semantic value in written language
                [Unicode:3](http://www.unicode.org/versions/Unicode8.0.0/ch02.pdf).
              - If you're dealing with text, you're most likely dealing with Unicode
              - Unicode is NOT a character encodings. That is, Unicode does
                not specify a single way to turn code points into binary for
                transmission, and storage. It defines several such formats,
                including UTF-8, and what JavaScript uses, UTF-16.
            </aside>
          </section>
        </section>

        <section>
          <section>
            <h3> It's time to play </h3>
            <h2 class="fragment">Is <span class="fragment">that</span></h2>
            <h1 class="fragment">‚õé‚ÑïŒπ‚äÇ‚óé ‚Ç´‚Ñá?</h1>
          </section>

          <section>
            <h1 class="display-character">
              √ü
            </h1>

            <div class="fragment">
              <div class="code-point"> U+00DF </div>
              <div class="unicode-name"> LATIN SMALL LETTER SHARP S </div>
            </div>
          </section>

          <section>
            <h1 class="display-character">
              ‡≤†
            </h1>

            <div class="fragment">
              <div class="code-point"> U+0CA0 </div>
              <div class="unicode-name"> KANNADA LETTER TTHA </div>
            </div>
          </section>

          <section>
            <h1 class="display-character">
              †Öò
            </h1>

            <div class="fragment">
              <div class="code-point"> U+20158 </div>
              <div class="unicode-name">CJK UNIFIED IDEOGRAPH-20158</div>
            </div>
            <p class="fragment"> <i>(Variant of modern</i> ‰∫≠ U+4EAD<i>)</i>
          </section>

          <section>
            <h1 class="display-character">
              ·ëø
            </h1>

            <div class="fragment">
              <div class="code-point">U+147F</div>
              <div class="unicode-name"> CANADIAN SYLLABICS WEST-CREE KWA</div>
            </div>
          </section>

          <section>
            <h1 class="display-character">
              üóø
            </h1>

            <div class="fragment">
              <div class="code-point">U+1F5FF</div>
              <div class="unicode-name">MOYAI</div>
            </div>
          </section>

          <section>
            <h1 class="display-character">
              J
            </h1>

            <div class="fragment">
              <div class="code-point">U+004A</div>
              <div class="unicode-name">LATIN CAPITAL LETTER J</div>
            </div>
          </section>
        </section>

        <section>
          <section>
            <h2> <a href="http://unicode.org/glossary/#code_point"> Code Points </a> </h2>
            <p> Unique number given to each character </p>
            <!-- insert some example code points -->

            <p class="fragment"> They look like this: </p>
            <p class="fragment"> <code>U+<span class="placeholder">hhhh</span></code> or <code>U+<span class="placeholder">hhhhhh</span></code> </p>

            <p class="fragment"> Range from <code><strong>U+0000</strong></code> to <code><strong>U+10FFFF</strong></code> </p>

            <div class="fragment">
              <p> 1,114,112 code points available in total </p>

              <p> <small>(See <a href="http://www.unicode.org/versions/Unicode8.0.0/ch02.pdf">Unicode Chapter 3</a>)</small> </p>
            </div>
          </section>

          <section>
            <h1> A tour of the Unicode character space! </h1>
            <p class="fragment"> Code points are divided into 17 <em> <a href="http://unicode.org/glossary/#plane">planes</a> </em> </p>
          </section>

          <section>
            <h2> The Basic Multilingual Plane </h2>
            <img src="./img/Roadmap_to_Unicode_BMP.svg" alt="Map of the Basic Multilingual Plane">
          </section>

          <section>
            <h2> The Basic Multilingual Plane </h2>
            <h3> (Plane 0) </h3>
            <ul>
              <li class="fragment"> Characters from practically all widely-used modern-day scripts </li>
              <li class="fragment"> Code points are notated as <code>U+<span class="placeholder">hhhh</span></code> </li>
              <li class="fragment"> Code points range from <strong><code>U+0000</code></strong> to <strong><code>U+FFFF</code></strong> </li>
            </ul>
          </section>

          <section>
            <h2> All Unicode Code Points </h2>
            <!-- Hack! highlight-blue class indicates the figure should zoom. -->
            <img class="fragment highlight-blue unicode-graph" src="./img/full-unicode.svg" alt="Diagram of all 17 Unicode planes">
          </section>

          <section>
            <h2> The Astral Planes </h2>
            <ul>
              <li class="fragment"> Everything else (Planes 1-16) </li>
              <li class="fragment"> Characters from ancient scripts, alternative scripts,
                pictograms, and rare and archaic CJK(V) ideograms (Chinese-style
                  characters). <span
                  class="fragment"> Also, (most) Emoji. </span> </li>
              <li class="fragment"> Two entire planes devoted to <em>private use characters</em> </li>
              <li class="fragment"> Code points are notated as <strong><code>U+<span class="placeholder">hhhhhh</span></code></strong> </li>
              <li class="fragment"> Code points range from <code>U+010000</code> to <code>U+10FFFF</code> </li>
            </ul>
          </section>

          <section>
            <!-- HACK: two non-breaking spaces to deal with kerning... -->
            <h1> What is <em>not</em>&nbsp;&nbsp;Unicode? </h1>
            <ul>
              <li class="fragment"> <del>a character encoding</del>
                <span class="fragment"> It's several character encodings! </span>
              <li class="fragment"> Code points ‚â† Bytes
            </ul>
            <aside class="notes" data-markdown>
              - Oh no, character encodings!
            </aside>
          </section>

          <section>
            <h2> <a href="http://unicode.org/glossary/#code_unit">Code Unit</a> </h2>
            <p> Smallest unit of storage required to store or transmit a single character in an encoding scheme </p>
          </section>

          <section>
            <h2> Ways of transmitting code points </h2>

            <ul class="fragment">
              <li> UTF-8 </li>
              <li> UTF-16 </li>
              <li> UTF-32/UCS-4 </li>
            </ul>

            <aside class="notes" data-markdown>
              - So each of these forms note how many bits make up one code
                unit.
              - At this point, things should seem odd.
              - Why does UTF-32 exist, and why does JavaScript use UTF-16?
            </aside>
          </section>

          <section data-background="./img/some-astral-ass-shit.jpg">
            <h2 class="halo"> UTF-16 needs <strong>two code units</strong> to represent <strong>one astral code point</strong> </h2>

            <aside class="notes" data-markdown>
              - UTF-16 does this through *surrogate pairs*, but let's just leave
                that discussion for another time...
              - There's that phrase again! "Code unit". What does that mean?
            </aside>
          </section>

        </section>

        <section>
          <section>
            <h2> Back to our problem... </h2>
            <p> We want to count
              <strong> code points </strong>
              and not
              <strong> code units </strong>
            </p>
          </section>

          <section>
            <h2>Enter: </h2>
            <h3><a href="http://www.ecma-international.org/ecma-262/6.0/#sec-string.prototype-@@iterator"><code>String.prototype[@@iterator]</code></a></h3>

            <p class="fragment">
              <small>(<code>String.prototype.codePointAt()</code> exists too)</small>
            </p>

            <aside class="notes" data-markdown>
              - among the slew of new features ES6 introduced are iterators
              - The one for String iterates through code points!
            </aside>
          </section>

          <section>
            <blockquote>
              When the @@iterator method is called it returns an Iterator
              object (<a href="http://www.ecma-international.org/ecma-262/6.0/#sec-iterator-interface">25.1.1.2</a>)
              that <strong>iterates over the code points</strong> of a String
              value, returning each code point as a String value.
            </blockquote>
          </section>

          <section>
            <h2>Compare</h2>
            <pre><code data-trim>
let a = [];
for (let c of s) {
  a.push(c);
}
            </code></pre>

            <h3>vs.</h3>

            <pre><code data-trim>
var i, a = [],
for (i = 0; i &lt; s.length; i++) {
  a.push(s[i]);
}
            </code></pre>

            <aside data-markdown class="notes">
              - it's not just neater; it iterates over completely different
                things! The iterator gives you code points -- characters --
                guaranteed! The C-style for-loop gives you 16-bit values, that
                just usually happen to be code points.
            </aside>
          </section>

          <section>
            <h2> Let's fix our code! </h2>

            <p class="fragment"> Trick: Use <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-array.from">Array#from</a> </p>

            <span class="fragment">
              (it just does this:)
              <pre><code data-trim>
function (s) {
  let array = [];
  for (let c of s) {
    a.push(c);
  }
  return a;
}
            </code></pre>
          </span>
          </section>
        </section>

        <section>
          <section>
            <h1> Change of plans </h1>

            <aside data-markdown class="notes">
              - The CEO had a revelation, and it turns out that Bitter is too
                similar to Twitter. Who would have thought? So, we're shifting
                gears; we're gonna be a restaurant review site instead! (there
                aren't any of those around, are there?)
            </aside>
          </section>

          <section>
            <img src="./img/bitter-food.png" alt="bitter" class="no-border bitter-logo">

            <p>
              <small> (Thanks, <a href="http://kimber.github.io/">Kim</a>!) </small>
            </p>
          </section>

          <section>
            <h2> (demo) </h2>
          </section>
        </section>

        <section>
          <section>
            <h2> Three different ways of writing üç≤ </h2>
            <ul>
              <li>ph·ªü <!-- use NFC character... my font renders it wrong --> <span class="fragment"> = <span class="decomp">o + ‚óåÃõ + ‚óåÃâ</span> </span></li>
              <li>ph∆°Ãâ <span class="fragment"> = <span class="decomp">∆° + ‚óåÃâ</strong> </span></li>
              <li>ph·ªü <span class="fragment"> = <span class="decomp">·ªü</span> </span></li>
            </ul>
          </section>

          <section>
            <p> There are multiple ways of representing the same
              <em>abstract</em> character sequence </p>
          </section>

          <section>
            <h1>Normalization forms!</h1>

            <p> Useful for comparing <em>different representations</em> of the same
              abstract character sequence </p>
          </section>

          <section>
            <ul>
              <li><strong> NFD </strong> Canonical decomposition </li>
              <li><strong> NFC </strong> Canonical decomposition, followed by Canonical Composition</li>
              <li><strong> NFKD </strong> Compatibility Decomposition</li>
              <li><strong> NFKC </strong> Compatibility Decomposition, followed by Canonical Composition </li>
            </ul>

            <p>
              <small> (See <a href="http://unicode.org/reports/tr15/"> UAX #15</a>) </small>
            </p>

            <aside data-markdown class="notes">
              - There are four normalization forms, of which we'll discuss two
              - There's NFD, canonical decomposition -- essentially, this
                breaks apart characters that can be represented by multiple
                combining characters, and sorts the combining characters
                (usually accents) in a "canonical" order.
              - Then there's NFC, which is just like NFD, except it pieces
                those combining characters back together again.
              - So many words! Which one is useful?
            </aside>
          </section>

          <section>
            <h2> Canonical Composition </h2>
            <ul>
              <li class="fragment"><strong> NFD</strong>: <span class="decomp">o + ‚óåÃõ + ‚óåÃâ</span>
              <li class="fragment"><strong> NFC</strong>: <span class="decomp">·ªü</span>
            </ul>
          </section>

          <section>
            <h2>Enter: </h2>
            <h3><a href="http://www.ecma-international.org/ecma-262/6.0/#sec-string.prototype.normalize"><code>String.prototype.normalize()</code></a></h3>

            <aside class="notes" data-markdown>
              - That's why ES6 introduced String#normalize()
              - Can convert into any of the four normalization forms.
              - **NOT** available in Core.JS, though modern browsers (such as
                Chrome, FireFox, and Edge [but not Safari :c]) provided it built-in.
            </aside>
          </section>

          <section>
            <p> When in doubt, use </p>
            <h2> NFC </h2>

            <aside class="notes" data-markdown>
              - When in doubt, use NFC.
              - In fact, if you provide no argument to String.normalize(),
                it does NFC by default.
              - It gives you one character for any accented non-sense for
                which that makes sense.
              - Twitter uses it internally, even if its character counter doesn't.
            </aside>
          </section>

          <section>
            <h2> Caveat: </h2>
            <p> Not available in Safari </p>
            <p> Not available in core.js </p>
            <p> Check the <a href="https://kangax.github.io/compat-table/es6/#test-String.prototype_methods">compatibility table</a> for more details! </p>
          </section>
        </section>

        <section>
          <section>
            <h1> Odds & Ends </h1>
          </section>

          <section>
            <h2> Regexes </h2>

            <pre><code data-trim>
'üçâ'.match(/[üçÖ-üçì]/) // => false
            </code></pre>

            <div class="fragment">
              <h3>vs.</h3>
              <pre><code data-trim>
'üçâ'.match(/[üçÖ-üçì]/u) // => true
              </code></pre>
            </div>

            <p class="fragment">
              <strong> Poorly supported! </strong>
            </p>
          </section>

          <section>
            <h2> Astral code point escape </h2>

            <li class="fragment"> to escape a BMP character: <code>"\u0CA0"</code> = ‡≤† </li>
            <li class="fragment"> to escape a non-BMP character: <code>"\u{10305}"</code> = êåÖ </li>
            <!-- TODO: change this with supplementary ideographic plane
              character. -->
          </section>

          <section>
            <h2> <code>codePointAt()</code> vs. <code>charCodeAt()</code> </h2>
            <h2 class="fragment"> <code>fromCodePoint()</code> vs. <code>fromCharCode()</code> </h2>
          </section>

          <section>
            <h2> Identifiers </h2>
            <p> (A.K.A., variable names) </p>

            <p class="fragment"> <a href="http://www.unicode.org/reports/tr31/">UAX #31</a> defines what a character is </p>
            <p class="fragment"> <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-names-and-keywords">The standard</a> adds <code>$</code> and <code>_</code> to this definition. </p>

            <p class="fragment"> <a href="https://mothereff.in/js-variables"> ES6 variable name validator </a> </p>
          </section>

          <section>
            <h2> Compatibility </h2>

            <p> Check the <a href="https://kangax.github.io/compat-table/es6/#test-String.prototype_methods">compatibility table</a>! </p>
          </section>

        </section>

        <section>
          <h1> ASK ME QUESTIONS </h1>
        </section>

        <section>
          <section>
            <h1> Resources </h1>
          </section>

          <section>
            <h2> Standards </h2>
            <ul>
              <li>
                <a href="www.unicode.org/versions/Unicode8.0.0/">Unicode 8.0</a>
              </li>
              <li>
                <a href="http://www.ecma-international.org/ecma-262/6.0/">ECMAScript 6</a>
              </li>
            </ul>
          </section>

          <section>
            <h2> Unicode </h2>

            <ul>
              <li>
                <a href="https://www.youtube.com/watch?v=zi0w7J7MCrk">Mathias Bynens: JavaScript ‚ô• Unicode</a>
              </li>
              <li>
                <a href="https://www.youtube.com/watch?v=MijmeoH9LT4">Tom Scott: Characters, Symbols and the Unicode Miracle</a>
              </li>
              <li>
                <a href="https://www.youtube.com/watch?v=tITwM5GDIAI">Tom Scott: Emoji and the Levitating Businessman</a>
              </li>
              <li>
                <a href="https://www.youtube.com/watch?v=qOcxwRc2Epg">Tom Scott: Why You Can Tweet More In Japanese: What Counts As A Character? </a>
              </li>
              <li>
                <a href="https://www.youtube.com/watch?v=3AtBE9BOvvk">Tom Scott: Real Life Emoji Keyboard!</a>
              </li>
            </ul>
          </section>

          <section>
            <h2> Other </h2>
            <ul>
              <li>
                <a href="http://utf8everywhere.org/">UTF-8 Everywhere</a>
              </li>
              <li>
                <a href="https://mathiasbynens.be/notes/javascript-unicode">JavaScript has a Unicode problem</a>
              </li>
            </ul>
          </section>
        </section>


      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true },
          { src: 'plugin/notes/notes.js', async: true }
        ]
      });

    </script>
  </body>
</html>
